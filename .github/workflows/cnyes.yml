name: Update Investment News

on:
 schedule:
 - cron: "* * * * *" # 每天 UTC 00:00 執行(台灣時間 +8 小時)
 workflow_dispatch: # 允許手動觸發

permissions:
 contents: write

jobs:
 update-sheet:
  runs-on: ubuntu-latest
  steps:
   - name: Checkout repository
     uses: actions/checkout@v4
     with:
      persist-credentials: true # 預設即為true，保險寫上

   - name: Set up Python
     uses: actions/setup-python@v4
     with:
      python_version: "3.10"

   - name: Install dependencies
     run: |
      pip install requests pandas openpyxl

   - name: Run script
     run: python cnyes.py

   - name: Save csv
     run: |
      git config --global user.name "Jennifer"
      git config --global user.email "jenniferschooluse@gmail.com"
      if git diff --cached --quiet; then
       echo "No changes to commit"
       exit 0
      fi
      git add -A
      git commit -m "update investment news"
      git push
